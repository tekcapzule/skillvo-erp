/* Import theme abstracts for access to mixins and variables */
@use 'styles/abstracts' as *;
@use 'styles/utilities/scrollbar' as scrollbar;

// ========================================
// Main Layout Variables
// ========================================

:root {
  // ========================================
  // Main Layout Structure
  // ========================================
  
  /* Main Layout Sizing */
  --main-content-min-height: calc(100vh - var(--header-height, 64px));
  --main-content-margin-top: var(--header-height, 64px);
  --main-content-margin-left: var(--sidenav-width, 240px);
  --main-content-collapsed-margin-left: var(--sidenav-width-collapsed, 64px);
  
  /* Main Layout Padding */
  --main-content-padding: var(--space-6, 24px);
  --main-content-mobile-padding: var(--space-4, 16px);
  
  // ========================================
  // Layout Components
  // ========================================
  
  // Main layout
  --layout-bg: var(--bg-app);
  --layout-content-padding: var(--space-6, 24px);
  --layout-content-padding-mobile: var(--space-4, 16px);
  
  // Sidenav integration
  --layout-with-sidenav-margin: var(--sidenav-width, 240px);
  --layout-with-collapsed-sidenav-margin: var(--sidenav-width-collapsed, 64px);
  --sidenav-width-collapsed: 64px;
  --sidenav-width: 240px;
  
  // Panels and slide-ins
  --panel-default-width: 360px;
  --panel-max-width: 90vw;
  
  // Mobile fab button
  --layout-fab-bottom: var(--space-6, 24px);
  --layout-fab-right: var(--space-6, 24px);
  --layout-fab-size: 56px;
  --layout-fab-color: var(--text-on-dark);
  --layout-fab-bg: var(--primary-500);
  
  // Mobile backdrop
  --layout-backdrop-color: var(--overlay-bg, rgba(0, 0, 0, 0.5));
  --layout-backdrop-z-index: 999;
  
  // ========================================
  // Layout Colors
  // ========================================
  
  /* Main Layout Colors */
  --main-content-bg: var(--bg-body);
  --main-content-text: var(--text-primary);
  
  // ========================================
  // Layout Animation & Effects
  // ========================================
  
  /* Main Layout Animation */
  --main-layout-transition-duration: 0.3s;
  --main-layout-transition-timing: ease-in-out;
  --layout-backdrop-transition: 0.3s ease;
  
  // ========================================
  // Layout Z-index Layers
  // ========================================
  
  /* Main Layout Z-index */
  --main-layout-z-index: var(--z-0, 0);
  
  // ========================================
  // Layout Scrollbar
  // ========================================
  
  /* Main Layout Scrollbar */
  --main-layout-scrollbar-width: 8px;
  --main-layout-scrollbar-thumb-color: var(--neutral-300);
  --main-layout-scrollbar-track-color: var(--bg-body);
  
  // ========================================
  // Responsive Breakpoints
  // ========================================
  
  /* Main Layout Responsive Breakpoints */
  --main-layout-tablet-breakpoint: var(--breakpoint-md, 768px);
  --main-layout-mobile-breakpoint: var(--breakpoint-sm, 576px);
  
  /* Content Area Settings */
  --layout-container-width: var(--breakpoint-xl, 1200px);
  --layout-container-padding: var(--space-6, var(--inset-lg));
  
  /* Backdrop Overlay */
  --backdrop-bg: rgba(0, 0, 0, 0.5);
  --backdrop-z-index: var(--z-40);
  --backdrop-transition-duration: 0.3s;
  --backdrop-transition-timing: ease;
  
  /* Mobile FAB Menu Button */
  --mobile-fab-size: var(--space-14, 56px);
  --mobile-fab-margin: var(--space-6, 24px);
  --mobile-fab-bg: var(--primary-500);
  --mobile-fab-color: var(--text-on-dark);
  --mobile-fab-z-index: var(--z-30);
  
  /* Layout Z-index Layers */
  --layout-z-index-base: var(--z-0);
  --layout-z-index-content: var(--z-10);
  --layout-z-index-overlay: var(--z-40);
  
  /* Layout Scrollbar */
  --layout-scrollbar-width: var(--space-2, 8px);
  --layout-scrollbar-thumb-color: var(--neutral-300);
  --layout-scrollbar-track-color: var(--bg-body);
  
  /* Layout Breakpoints */
  --layout-breakpoint-sm: var(--breakpoint-sm, 576px);
  --layout-breakpoint-md: var(--breakpoint-md, 768px);
  --layout-breakpoint-lg: var(--breakpoint-lg, 992px);
  --layout-breakpoint-xl: var(--breakpoint-xl, 1200px);
}

// ========================================
// Dark Theme Overrides
// ========================================

[data-theme="dark"] {
  --layout-bg: var(--bg-app);
  --layout-fab-bg: var(--primary-500);
  --layout-fab-color: var(--text-on-dark);
  --main-content-bg: var(--bg-body);
  --main-content-text: var(--text-primary);
  --main-layout-scrollbar-thumb-color: var(--neutral-600);
  --main-layout-scrollbar-track-color: var(--bg-body);
  --backdrop-bg: rgba(0, 0, 0, 0.7);
  --mobile-fab-bg: var(--primary-500);
  --mobile-fab-color: var(--text-on-dark);
}

// ========================================
// Main Container
// ========================================

.main-container {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  background-color: var(--layout-bg);
  position: relative;
  overflow-x: hidden;
}

.main-content-container {
  display: flex;
  height: calc(100vh - var(--header-height));
  position: relative;
  overflow: hidden;
  margin-top: var(--header-height);
  background-color: var(--bg-primary);
  
  [data-theme="dark"] & {
    background-color: var(--bg-primary, #121212);
  }
}

.content-wrapper {
  flex: 1;
  height: 100%;
  width: calc(100% - var(--sidenav-width));
  background-color: var(--bg-primary);
  overflow: hidden;
  transition: margin-left var(--sidenav-transition-duration, 0.3s) var(--sidenav-transition-timing, ease-in-out),
              width var(--sidenav-transition-duration, 0.3s) var(--sidenav-transition-timing, ease-in-out),
              background-color 0.3s ease;
  
  [data-theme="dark"] & {
    background-color: var(--bg-primary, #121212);
  }
  
  &.with-sidebar {
    margin-left: var(--sidenav-width);
    width: calc(100% - var(--sidenav-width));
  }
  
  &.with-collapsed-sidebar {
    margin-left: var(--sidenav-width-collapsed, 64px);
    width: calc(100% - var(--sidenav-width-collapsed, 64px));
  }
}

.content-container {
  padding: var(--main-content-padding, 24px 32px);
  height: calc(100% - var(--breadcrumb-height));
  overflow-y: auto;
  overflow-x: hidden;
  background-color: var(--bg-primary);
  transition: background-color 0.3s ease, padding 0.3s ease;
  @include scrollbar.styled-scrollbar;
  
  [data-theme="dark"] & {
    background-color: var(--bg-primary, #121212);
  }
}

/* Floating mobile hamburger button */
.mobile-fab-menu {
  display: none;
  position: fixed;
  bottom: var(--mobile-fab-margin, 24px);
  right: var(--mobile-fab-margin, 24px);
  z-index: var(--mobile-fab-z-index, 9999);
  background-color: var(--mobile-fab-bg, var(--primary-500, #0066ff));
  color: var(--mobile-fab-color, white);
  box-shadow: var(--shadow-lg, 0 4px 8px rgba(0, 0, 0, 0.2));
  width: var(--mobile-fab-size, 56px);
  height: var(--mobile-fab-size, 56px);
  border-radius: 50%;
  border: none;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-xl, 0 6px 12px rgba(0, 0, 0, 0.3));
  }
  
  &:active {
    transform: scale(0.95);
  }
  
  /* Center the icon */
  mat-icon {
    margin: auto;
  }
}

/* Mobile backdrop */
.mobile-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--backdrop-bg, rgba(0, 0, 0, 0.5));
  z-index: var(--backdrop-z-index, 999);
  visibility: hidden;
  opacity: 0;
  transition: opacity var(--backdrop-transition-duration, 0.3s) var(--backdrop-transition-timing, ease),
              visibility var(--backdrop-transition-duration, 0.3s) var(--backdrop-transition-timing, ease);
  
  [data-theme="dark"] & {
    background-color: var(--backdrop-bg, rgba(0, 0, 0, 0.7));
  }
  
  &.active {
    visibility: visible;
    opacity: 1;
  }
}

// Responsive adjustments
@include breakpoint-down('md') {
  .content-wrapper {
    margin-left: 0 !important;
    width: 100% !important;
  }
  
  .content-container {
    padding: var(--main-content-mobile-padding, 16px 20px);
  }
  
  .mobile-fab-menu {
    display: flex;
    align-items: center;
    justify-content: center;
  }
}

@include breakpoint-down('sm') {
  .content-container {
    padding: var(--layout-content-padding-mobile, 12px 16px);
  }
} 