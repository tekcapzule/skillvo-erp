<div class="demo-shell-container" *ngIf="activeDemo">
  <header class="demo-header">
    <h1>{{ activeDemo.name }}</h1>
    <p *ngIf="activeDemo.description">{{ activeDemo.description }}</p>
  </header>

  <mat-tab-group (selectedIndexChange)="onTabChange($event)" [selectedIndex]="activeTabIndex">
    <!-- Overview Tab -->
    <mat-tab label="Overview">
      <div class="tab-content">
        <!-- Component Variants Section -->
        <section class="component-variants-section">
          <h2>Component Variants</h2>
          <p>The component supports multiple variants for different use cases and visual styles.</p>
          
          <div class="variants-grid">
            <div *ngFor="let variant of activeDemo.variants" class="variant-item">
              <div class="variant-preview">
                <ng-container #variantContainer></ng-container>
              </div>
              <div class="variant-info">
                <h3>{{ variant.name }}</h3>
                <p *ngIf="variant.description">{{ variant.description }}</p>
                <div class="variant-properties" *ngIf="variant.properties">
                  <demo-code-preview 
                    [code]="getVariantPropertiesString(variant.properties)"
                    language="html">
                  </demo-code-preview>
                </div>
              </div>
            </div>
          </div>
        </section>
        
        <!-- Documentation Section -->
        <section class="documentation-section">
          <h2>Documentation</h2>
          
          <!-- Properties Table -->
          <div class="properties-table-container">
            <h3>Properties</h3>
            <table class="properties-table">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Type</th>
                  <th>Default</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let prop of activeDemo.properties">
                  <td class="prop-name">{{ prop.name }}</td>
                  <td class="prop-type">{{ prop.type }}</td>
                  <td class="prop-default">{{ prop.defaultValue }}</td>
                  <td class="prop-description">{{ prop.description }}</td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <!-- Events Table -->
          <div class="events-table-container" *ngIf="activeDemo.events?.length">
            <h3>Events</h3>
            <table class="events-table">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let event of activeDemo.events">
                  <td class="event-name">{{ event.name }}</td>
                  <td class="event-description">{{ event.description }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>
        
        <!-- Code Examples Section -->
        <section class="code-examples-section">
          <h2>Code Examples</h2>
          <div class="code-snippets-container">
            <div *ngFor="let snippet of activeDemo.codeSnippets" class="code-snippet">
              <h3 *ngIf="snippet.title">{{ snippet.title }}</h3>
              <p *ngIf="snippet.description">{{ snippet.description }}</p>
              
              <demo-code-preview 
                [code]="snippet.code"
                [language]="snippet.language">
              </demo-code-preview>
            </div>
          </div>
        </section>
      </div>
    </mat-tab>

    <!-- Playground Tab -->
    <mat-tab label="Playground">
      <div class="tab-content playground-container">
        <div class="playground-horizontal-layout">
          <div class="component-preview-wrapper">
            <div class="component-container">
              <!-- Debug placeholder to ensure container is visible -->
              <div class="component-debug-placeholder">Component will appear here</div>
              
              <!-- Component container with direct rendering -->
              <div class="component-mount-point">
                <ng-container #componentContainer></ng-container>
              </div>
              
              <!-- Fallback element for buttons - updated with better styling -->
              <div *ngIf="activeDemo?.id === 'button-component' && !componentInstance" class="fallback-button-container">
                <button class="sv-button sv-button-primary sv-ui-size-md">
                  <span class="sv-button-content">Primary Button</span>
                </button>
              </div>

              <!-- Fallback element for button groups -->
              <div *ngIf="activeDemo?.id === 'button-group-component' && !componentInstance" class="fallback-button-group-container">
                <div class="sv-button-group sv-button-group-outline">
                  <div class="sv-button-group-container">
                    <button class="sv-button sv-button-outline sv-ui-size-md">
                      <span class="sv-button-content">Left</span>
                    </button>
                    <button class="sv-button sv-button-outline sv-ui-size-md">
                      <span class="sv-button-content">Middle</span>
                    </button>
                    <button class="sv-button sv-button-outline sv-ui-size-md">
                      <span class="sv-button-content">Right</span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="playground-tabs-container">
            <mat-tab-group mat-stretch-tabs="false" mat-align-tabs="start" (selectedIndexChange)="onPlaygroundTabChange($event)" [selectedIndex]="playgroundTabIndex">
              <mat-tab label="Properties">
                <div class="playground-tab-content">
                  <demo-property-editor 
                    [componentInstance]="componentInstance" 
                    [properties]="activeDemo.properties">
                  </demo-property-editor>
                </div>
              </mat-tab>
              
              <mat-tab label="Events">
                <div class="playground-tab-content">
                  <demo-event-monitor></demo-event-monitor>
                </div>
              </mat-tab>
            </mat-tab-group>
          </div>
        </div>
      </div>
    </mat-tab>

    <!-- Responsive Tab -->
    <mat-tab label="Responsive">
      <div class="tab-content responsive-container">
        <div class="responsive-horizontal-layout">
          <div class="viewport-simulator-wrapper">
            <div class="viewport-info">
              <span class="viewport-dimensions">{{ currentViewport.width }} × {{ currentViewport.height }}px</span>
              <span class="viewport-name" *ngIf="selectedViewport !== 'custom'">{{ getCurrentViewportName() }}</span>
            </div>
            
            <div class="viewport-frame" [style.width.px]="currentViewport.width" [style.height.px]="currentViewport.height">
              <div class="viewport-content" [attr.data-size]="currentViewport.width + '×' + currentViewport.height">
                <ng-container #responsiveComponentContainer></ng-container>
                
                <!-- Fallback display if component doesn't render -->
                <div *ngIf="activeDemo?.id === 'button-component' && !componentInstance" class="responsive-fallback-button">
                  <button class="sv-button sv-button-primary sv-ui-size-md">
                    <span class="sv-button-content">Primary Button</span>
                  </button>
                </div>

                <!-- Fallback for button group -->
                <div *ngIf="activeDemo?.id === 'button-group-component'" class="responsive-fallback-button-group">
                  <div class="sv-button-group sv-button-group-outline">
                    <div class="sv-button-group-container">
                      <button class="sv-button sv-button-outline sv-ui-size-md">
                        <span class="sv-button-content">Left</span>
                      </button>
                      <button class="sv-button sv-button-outline sv-ui-size-md">
                        <span class="sv-button-content">Middle</span>
                      </button>
                      <button class="sv-button sv-button-outline sv-ui-size-md">
                        <span class="sv-button-content">Right</span>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="responsive-controls-container">
            <h3>Viewport Settings</h3>
            <div class="viewport-controls">
              <h4>Device Presets</h4>
              <div class="viewport-presets">
                <button 
                  *ngFor="let preset of viewportPresets" 
                  class="viewport-preset-button" 
                  [class.active]="selectedViewport === preset.id"
                  (click)="setViewportSize(preset)">
                  {{ preset.name }}
                </button>
              </div>
              
              <h4>Custom Size</h4>
              <div class="viewport-custom">
                <div class="viewport-size-inputs">
                  <div class="input-group">
                    <label>Width:</label>
                    <div class="input-with-unit">
                      <input 
                        type="number" 
                        [(ngModel)]="customViewport.width" 
                        (input)="applyCustomViewport()"
                        min="320" 
                        max="1920" 
                        step="10">
                      <span class="unit">px</span>
                    </div>
                  </div>
                  <div class="input-group">
                    <label>Height:</label>
                    <div class="input-with-unit">
                      <input 
                        type="number" 
                        [(ngModel)]="customViewport.height" 
                        (input)="applyCustomViewport()"
                        min="320" 
                        max="1080" 
                        step="10">
                      <span class="unit">px</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>

<mat-card class="no-demo-message" *ngIf="!activeDemo">
  <mat-card-content>
    <p>No component demo selected or available.</p>
  </mat-card-content>
</mat-card> 