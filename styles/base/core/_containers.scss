/**
 * Container Controls Base - Core Styles
 * Version: 2.0.0
 * Last Updated: June 29, 2024
 * 
 * This file establishes the foundational styles for all container components
 * in the SkillVo design system. It serves as the second level in our 
 * three-tier styling architecture:
 * 1. sv-ui-control-base - Base styles for all interactive controls
 * 2. sv-container-control-base (this file) - Base styles for all container components
 * 3. Component-specific classes (e.g., sv-card, sv-panel, sv-accordion)
 * 
 * For extension points and layer boundaries documentation, see:
 * styles/docs/base-control-extensions.md
 */

/* ==========================================================================
   TABLE OF CONTENTS:
   
   1. IMPORTS
   2. VARIABLES & CONFIGURATION
   3. BASE CLASS DEFINITION
   4. CONTAINER STRUCTURE COMPONENTS
   5. CONTAINER VARIATIONS
   6. STATE VARIATIONS
   7. SIZE VARIATIONS
   8. ACCESSIBILITY ENHANCEMENTS
   ========================================================================== */

/* ==========================================================================
   1. IMPORTS
   ========================================================================== */
@use 'sass:map';
@use './../../abstracts' as *;
@use './../utils/mixins/state' as state;
@use './../utils/mixins/layout' as layout;
@use './../utils/mixins/typography' as typography;
@use './../utils/mixins/accessibility' as a11y;

/* ==========================================================================
   2. VARIABLES & CONFIGURATION
   ========================================================================== */

// Container-specific variables
$container-border-width: 1px;
$container-padding: var(--sv-space-4);
$container-header-padding: var(--sv-space-3) var(--sv-space-4);
$container-body-padding: var(--sv-space-4);
$container-footer-padding: var(--sv-space-3) var(--sv-space-4);

/* ==========================================================================
   3. BASE CLASS DEFINITION
   ========================================================================== */

/**
 * The sv-container-control-base class provides foundational styling for all
 * container components such as cards, panels, and dialogs.
 * 
 * This class extends sv-ui-control-base and adds container-specific styling.
 */
.sv-container-control-base {
  // Inherit all base UI control styles
  @extend .sv-ui-control-base !optional;
  
  // Box model adjustments for containers
  display: block;
  width: 100%;
  padding: 0;
  margin: 0;
  
  // Container-specific styling
  background-color: var(--sv-bg-surface);
  border: $container-border-width solid var(--sv-border-light);
  border-radius: var(--sv-radius-md);
  box-shadow: var(--sv-shadow-sm);
  overflow: visible;
  
  // Structure elements
  &__header {
    position: relative;
    padding: $container-header-padding;
    border-bottom: $container-border-width solid var(--sv-border-light);
    background-color: var(--sv-bg-element);
    border-top-left-radius: calc(var(--sv-radius-md) - 1px);
    border-top-right-radius: calc(var(--sv-radius-md) - 1px);
  }
  
  &__body {
    position: relative;
    padding: $container-body-padding;
  }
  
  &__footer {
    position: relative;
    padding: $container-footer-padding;
    border-top: $container-border-width solid var(--sv-border-light);
    background-color: var(--sv-bg-element);
    border-bottom-left-radius: calc(var(--sv-radius-md) - 1px);
    border-bottom-right-radius: calc(var(--sv-radius-md) - 1px);
  }
  
  // Focus behavior specific to containers should be more subtle
  &:focus {
    box-shadow: var(--sv-shadow-md);
    border-color: var(--sv-border-medium);
  }
  
  // Container hover behavior (only for interactive containers)
  &.is-interactive:hover:not(:disabled):not(.disabled) {
    background-color: var(--sv-bg-element-hover);
    border-color: var(--sv-border-medium);
  }
  
  // Disabled state for containers
  &:disabled,
  &.disabled {
    opacity: 0.75; // Less opacity than standard controls
    pointer-events: none;
  }
}

/* ==========================================================================
   4. CONTAINER STRUCTURE COMPONENTS
   ========================================================================== */

.sv-container-control-base {
  // Container title components
  &__title {
    margin: 0;
    font-size: var(--sv-font-size-lg);
    font-weight: var(--sv-font-weight-semibold);
    color: var(--sv-text-primary);
  }
  
  &__subtitle {
    margin: var(--sv-space-1) 0 0;
    font-size: var(--sv-font-size-base);
    color: var(--sv-text-secondary);
  }
  
  // Close button for dismissible containers
  &__close {
    position: absolute;
    top: var(--sv-space-2);
    right: var(--sv-space-2);
    width: var(--sv-size-8);
    height: var(--sv-size-8);
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--sv-radius-full);
    background-color: transparent;
    border: none;
    cursor: pointer;
    color: var(--sv-text-secondary);
    
    &:hover {
      background-color: var(--sv-bg-element-hover);
      color: var(--sv-text-primary);
    }
    
    &:focus {
      @include state.focus-state;
    }
  }
  
  // Scrollable container body
  &__body--scrollable {
    max-height: var(--sv-size-96);
    overflow-y: auto;
    
    &::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    &::-webkit-scrollbar-track {
      background-color: var(--sv-bg-element);
      border-radius: 4px;
    }
    
    &::-webkit-scrollbar-thumb {
      background-color: var(--sv-border-medium);
      border-radius: 4px;
      
      &:hover {
        background-color: var(--sv-border-dark);
      }
    }
  }
  
  // Actions container for buttons/controls
  &__actions {
    display: flex;
    align-items: center;
    gap: var(--sv-space-2);
    
    &--end {
      justify-content: flex-end;
    }
    
    &--between {
      justify-content: space-between;
    }
    
    &--center {
      justify-content: center;
    }
  }
}

/* ==========================================================================
   5. CONTAINER VARIATIONS
   ========================================================================== */

.sv-container-control-base {
  // Elevation variations
  &.sv-elevation-none {
    box-shadow: none;
  }
  
  &.sv-elevation-sm {
    box-shadow: var(--sv-shadow-sm);
  }
  
  &.sv-elevation-md {
    box-shadow: var(--sv-shadow-md);
  }
  
  &.sv-elevation-lg {
    box-shadow: var(--sv-shadow-lg);
  }
  
  // Border variations
  &.sv-border-none {
    border: none;
  }
  
  &.sv-border-light {
    border-color: var(--sv-border-light);
  }
  
  &.sv-border-medium {
    border-color: var(--sv-border-medium);
  }
  
  &.sv-border-dark {
    border-color: var(--sv-border-dark);
  }
  
  // Shape variations
  &.sv-shape-sharp {
    border-radius: 0;
    
    .sv-container-control-base__header,
    .sv-container-control-base__footer {
      border-radius: 0;
    }
  }
  
  &.sv-shape-rounded-sm {
    border-radius: var(--sv-radius-sm);
    
    .sv-container-control-base__header {
      border-top-left-radius: calc(var(--sv-radius-sm) - 1px);
      border-top-right-radius: calc(var(--sv-radius-sm) - 1px);
    }
    
    .sv-container-control-base__footer {
      border-bottom-left-radius: calc(var(--sv-radius-sm) - 1px);
      border-bottom-right-radius: calc(var(--sv-radius-sm) - 1px);
    }
  }
  
  &.sv-shape-rounded-lg {
    border-radius: var(--sv-radius-lg);
    
    .sv-container-control-base__header {
      border-top-left-radius: calc(var(--sv-radius-lg) - 1px);
      border-top-right-radius: calc(var(--sv-radius-lg) - 1px);
    }
    
    .sv-container-control-base__footer {
      border-bottom-left-radius: calc(var(--sv-radius-lg) - 1px);
      border-bottom-right-radius: calc(var(--sv-radius-lg) - 1px);
    }
  }
  
  // Layout variations
  &.sv-layout-flex {
    display: flex;
    flex-direction: column;
  }
  
  &.sv-layout-grid {
    display: grid;
    grid-template-rows: auto 1fr auto;
  }
}

/* ==========================================================================
   6. STATE VARIATIONS
   ========================================================================== */

.sv-container-control-base {
  // Expanded state
  &.is-expanded {
    border-color: var(--sv-border-medium);
    box-shadow: var(--sv-shadow-md);
  }
  
  // Collapsed state
  &.is-collapsed {
    .sv-container-control-base__body,
    .sv-container-control-base__footer {
      display: none;
    }
  }
  
  // Highlighted state
  &.is-highlighted {
    border-color: var(--sv-primary);
    box-shadow: 0 0 0 1px var(--sv-primary-light);
  }
  
  // Error state
  &.has-error {
    border-color: var(--sv-error);
    
    .sv-container-control-base__header {
      border-bottom-color: var(--sv-error-light);
    }
  }
  
  // Warning state
  &.has-warning {
    border-color: var(--sv-warning);
    
    .sv-container-control-base__header {
      border-bottom-color: var(--sv-warning-light);
    }
  }
  
  // Success state
  &.has-success {
    border-color: var(--sv-success);
    
    .sv-container-control-base__header {
      border-bottom-color: var(--sv-success-light);
    }
  }
}

/* ==========================================================================
   7. SIZE VARIATIONS
   ========================================================================== */

.sv-container-control-base {
  // Small size
  &.sv-size-sm {
    .sv-container-control-base__header {
      padding: var(--sv-space-2) var(--sv-space-3);
    }
    
    .sv-container-control-base__body {
      padding: var(--sv-space-3);
    }
    
    .sv-container-control-base__footer {
      padding: var(--sv-space-2) var(--sv-space-3);
    }
    
    .sv-container-control-base__title {
      font-size: var(--sv-font-size-base);
    }
    
    .sv-container-control-base__subtitle {
      font-size: var(--sv-font-size-sm);
    }
  }
  
  // Default (medium) size inherits from base class
  
  // Large size
  &.sv-size-lg {
    .sv-container-control-base__header {
      padding: var(--sv-space-4) var(--sv-space-5);
    }
    
    .sv-container-control-base__body {
      padding: var(--sv-space-5);
    }
    
    .sv-container-control-base__footer {
      padding: var(--sv-space-4) var(--sv-space-5);
    }
    
    .sv-container-control-base__title {
      font-size: var(--sv-font-size-xl);
    }
    
    .sv-container-control-base__subtitle {
      font-size: var(--sv-font-size-lg);
    }
  }
}

/* ==========================================================================
   8. ACCESSIBILITY ENHANCEMENTS
   ========================================================================== */

.sv-container-control-base {
  // High contrast mode support
  @include a11y.high-contrast-mode {
    border: 1px solid ButtonText;
    
    .sv-container-control-base__header,
    .sv-container-control-base__footer {
      border-color: ButtonText;
    }
    
    &.is-highlighted {
      border-color: Highlight;
    }
    
    &.has-error,
    &.has-warning,
    &.has-success {
      border-color: ButtonText;
    }
  }
  
  // Support for reduced motion
  @include a11y.reduced-motion {
    transition: none !important;
    animation: none !important;
  }
  
  // Better keyboard navigation for interactive containers
  &.is-interactive:focus-visible {
    @include a11y.focus-visible-enhanced;
  }
}