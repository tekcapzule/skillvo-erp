/**
 * Card Component - Component-level Styles
 * Version: 1.1.0
 * Last Updated: June 30, 2024
 * 
 * This file defines styles for the Card component in the SkillVo design system.
 * It extends the container-control-base class and provides card-specific styling.
 */

/* ==========================================================================
   TABLE OF CONTENTS:
   
   1. VARIABLES & CONFIGURATION
   2. CARD BASE CLASS
   3. CARD VARIATIONS
      3.1 Card Types
      3.2 Card Sizes
      3.3 Card Visual Styles
   4. CARD ELEMENTS
      4.1 Card Header
      4.2 Card Body
      4.3 Card Footer
      4.4 Card Media
   5. CARD MODIFIERS
   6. RESPONSIVE BEHAVIORS
   ========================================================================== */

/* ==========================================================================
   1. VARIABLES & CONFIGURATION
   ========================================================================== */

// Import necessary mixins
@use './../../abstracts/variables/' as *;
@use './../../base/utils/mixins/state' as state;
@use './../../base/utils/mixins/layout' as layout;
@use './../../base/utils/mixins/responsive' as responsive;
@use 'sass:math';

// Card-specific variables
$card-border-width: 1px;
$card-default-radius: var(--sv-radius-md);
$card-default-shadow: var(--sv-shadow-md);
$card-header-padding: var(--sv-space-4);
$card-body-padding: var(--sv-space-4);
$card-footer-padding: var(--sv-space-4);
$card-border-color: var(--sv-border-light);
$card-header-border-color: var(--sv-border-light);
$card-footer-border-color: var(--sv-border-light);
$card-title-font-size: var(--sv-font-size-lg);
$card-title-font-weight: var(--sv-font-weight-semibold);
$card-subtitle-font-size: var(--sv-font-size-base);
$card-subtitle-font-weight: var(--sv-font-weight-normal);
$card-subtitle-color: var(--sv-text-secondary);
$card-media-aspect-ratio: math.div(16, 9);

/* ==========================================================================
   2. CARD BASE CLASS
   ========================================================================== */

/**
 * The sv-card class extends sv-container-control-base and represents a container
 * with content, often used to group related information in a visual unit.
 */
.sv-card {
  // Extend the container control base class
  @extend .sv-container-control-base;
  
  // Card-specific overrides - only add what's different from the base
  border-radius: $card-default-radius;
  box-shadow: $card-default-shadow;
  display: flex;
  flex-direction: column;
  overflow: hidden; // Ensures media content doesn't overflow rounded corners
  height: auto; // Cards naturally size to content
  
  // Enhanced hover effect for interactive cards
  &.is-interactive {
    transition: transform var(--sv-motion-duration-short) var(--sv-motion-ease-standard),
                box-shadow var(--sv-motion-duration-short) var(--sv-motion-ease-standard);
    cursor: pointer;
    
    &:hover:not(:disabled):not(.disabled) {
      transform: translateY(-4px);
      box-shadow: var(--sv-shadow-lg);
    }
    
    &:active:not(:disabled):not(.disabled) {
      transform: translateY(-2px);
    }
  }
  
  // Use BEM-style naming for card elements to match container-control-base pattern
  &__header {
    padding: $card-header-padding;
    display: flex;
    flex-direction: column;
    border-bottom: $card-border-width solid $card-header-border-color;
    
    // Alignment variations
    &--row {
      flex-direction: row;
      align-items: center;
      justify-content: space-between;
    }
    
    &--no-border {
      border-bottom: none;
    }
  }
  
  &__body {
    padding: $card-body-padding;
    flex: 1 1 auto;
  }
  
  &__footer {
    padding: $card-footer-padding;
    border-top: $card-border-width solid $card-footer-border-color;
    
    &--no-border {
      border-top: none;
    }
  }
  
  &__title {
    margin: 0;
    font-size: $card-title-font-size;
    font-weight: $card-title-font-weight;
    color: var(--sv-text-primary);
  }
  
  &__subtitle {
    margin: var(--sv-space-1) 0 0;
    font-size: $card-subtitle-font-size;
    font-weight: $card-subtitle-font-weight;
    color: $card-subtitle-color;
  }
  
  &__media {
    position: relative;
    width: 100%;
    
    // Default 16:9 aspect ratio
    &:not(.sv-card__media--custom-ratio) {
      &::before {
        content: "";
        display: block;
        padding-top: percentage(1 / $card-media-aspect-ratio);
      }
      
      img, picture, video {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
      }
    }
    
    // Square aspect ratio
    &--square::before {
      padding-top: 100%;
    }
    
    // 4:3 aspect ratio
    &--4-3::before {
      padding-top: percentage(3 / 4);
    }
    
    // 21:9 widescreen aspect ratio
    &--21-9::before {
      padding-top: percentage(9 / 21);
    }
    
    // Custom height media (no aspect ratio enforcement)
    &--custom-ratio {
      height: auto;
      
      img, picture, video {
        width: 100%;
        display: block;
      }
    }
  }
  
  // Content wrapper for better organization
  &__content {
    display: flex;
    flex-direction: column;
    flex: 1;
  }
}

/* ==========================================================================
   3. CARD VARIATIONS
   ========================================================================== */

/* 3.1 Card Types
   ========================================================================== */

.sv-card {
  // Basic card with minimal styling
  &--basic {
    box-shadow: none;
    border: $card-border-width solid $card-border-color;
  }
  
  // Elevated card with prominent shadow
  &--elevated {
    box-shadow: var(--sv-shadow-lg);
  }
  
  // Outlined card with no shadow
  &--outlined {
    box-shadow: none;
    border: $card-border-width solid $card-border-color;
  }
  
  // Card with no border or shadow
  &--flat {
    box-shadow: none;
    border: none;
    background-color: var(--sv-bg-element);
  }
  
  // Card optimized for horizontal layout
  &--horizontal {
    flex-direction: row;
    
    .sv-card__media {
      width: 33.333%;
      height: auto;
      
      &::before {
        content: none;
      }
      
      img, picture, video {
        position: static;
        height: 100%;
        object-fit: cover;
      }
    }
    
    .sv-card__content {
      width: 66.666%;
    }
    
    // Media queries for responsive behavior
    @include responsive.breakpoint-down(md) {
      flex-direction: column;
      
      .sv-card__media,
      .sv-card__content {
        width: 100%;
      }
    }
  }
}

/* 3.2 Card Sizes
   ========================================================================== */

.sv-card {
  // Compact card with smaller padding
  &--compact {
    .sv-card__header,
    .sv-card__body,
    .sv-card__footer {
      padding: var(--sv-space-2);
    }
  }
  
  // Comfortable card with larger padding
  &--comfortable {
    .sv-card__header,
    .sv-card__body,
    .sv-card__footer {
      padding: var(--sv-space-6);
    }
  }
}

/* 3.3 Card Visual Styles
   ========================================================================== */

.sv-card {
  // Card with rounded corners
  &--rounded {
    border-radius: var(--sv-radius-lg);
  }
  
  // Card with more square corners
  &--square {
    border-radius: var(--sv-radius-sm);
  }
  
  // Card with highlighted border
  &--highlighted {
    border-color: var(--sv-primary);
    border-width: 2px;
  }
  
  // Card with accent color strip
  &--accent {
    position: relative;
    
    &::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background-color: var(--sv-primary);
    }
  }
  
  &--accent-left {
    &::before {
      width: 4px;
      height: 100%;
    }
  }
  
  &--accent-right {
    &::before {
      width: 4px;
      height: 100%;
      left: auto;
      right: 0;
    }
  }
  
  &--accent-bottom {
    &::before {
      top: auto;
      bottom: 0;
    }
  }
}

/* ==========================================================================
   4. CARD ELEMENTS
   ========================================================================== */

/* 4.1 Card Header
   ========================================================================== */

.sv-card-header {
  padding: $card-header-padding;
  display: flex;
  flex-direction: column;
  border-bottom: 1px solid $card-header-border-color;
  
  // Header variations
  &.sv-card-header-no-border {
    border-bottom: none;
  }
  
  // Header with horizontal layout
  &.sv-card-header-row {
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
  }
  
  // Header with avatar/icon
  &.sv-card-header-with-avatar {
    display: flex;
    flex-direction: row;
    align-items: center;
    
    .sv-card-avatar {
      margin-right: var(--sv-space-sm);
    }
  }
}

// Card title styling
.sv-card-title {
  margin: 0;
  font-size: $card-title-font-size;
  font-weight: $card-title-font-weight;
  color: var(--sv-text-primary);
  line-height: var(--sv-leading-tight);
}

// Card subtitle styling
.sv-card-subtitle {
  margin: var(--sv-space-xs) 0 0;
  font-size: $card-subtitle-font-size;
  font-weight: $card-subtitle-font-weight;
  color: $card-subtitle-color;
  line-height: var(--sv-leading-normal);
}

// Card avatar/icon container
.sv-card-avatar {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  border-radius: var(--sv-radius-full);
  background-color: var(--sv-bg-element);
  overflow: hidden;
  
  img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  &.sv-card-avatar-sm {
    width: 32px;
    height: 32px;
  }
  
  &.sv-card-avatar-lg {
    width: 48px;
    height: 48px;
  }
}

/* 4.2 Card Body
   ========================================================================== */

.sv-card-body {
  padding: $card-body-padding;
  flex: 1 1 auto;
  
  // Body variations
  &.sv-card-body-no-padding {
    padding: 0;
  }
  
  &.sv-card-body-compact {
    padding: var(--sv-padding-sm);
  }
  
  &.sv-card-body-comfortable {
    padding: var(--sv-padding-lg);
  }
}

/* 4.3 Card Footer
   ========================================================================== */

.sv-card-footer {
  padding: $card-footer-padding;
  border-top: 1px solid $card-footer-border-color;
  display: flex;
  flex-direction: row;
  align-items: center;
  
  // Footer variations
  &.sv-card-footer-no-border {
    border-top: none;
  }
  
  &.sv-card-footer-end {
    justify-content: flex-end;
  }
  
  &.sv-card-footer-between {
    justify-content: space-between;
  }
  
  &.sv-card-footer-center {
    justify-content: center;
  }
  
  &.sv-card-footer-column {
    flex-direction: column;
    align-items: flex-start;
  }
}

/* 4.4 Card Media
   ========================================================================== */

.sv-card-media {
  position: relative;
  width: 100%;
  overflow: hidden;
  
  // Default aspect ratio
  &:not(.sv-card-media-free) {
    padding-top: calc(100% / $card-media-aspect-ratio); // Default 16:9
  }
  
  img, picture, video {
    width: 100%;
    display: block;
  }
  
  img, picture {
    object-fit: cover;
    object-position: center;
  }
  
  // For aspect ratio implementation
  &:not(.sv-card-media-free) {
    img, picture, video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  }
  
  // Media with overlay text
  .sv-card-media-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: var(--sv-padding-md);
    background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent);
    color: var(--sv-text-on-dark);
  }
  
  // Media with content overlay (fully covering image)
  .sv-card-media-content {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background-color: rgba(0, 0, 0, 0.5);
    color: var(--sv-text-on-dark);
    opacity: 0;
    transition: opacity 0.2s ease;
    
    &.sv-card-media-content-visible {
      opacity: 1;
    }
  }
}

// Different aspect ratios
.sv-card-media-1x1 {
  padding-top: 100%;
}

.sv-card-media-4x3 {
  padding-top: calc(100% * 3/4);
}

.sv-card-media-16x9 {
  padding-top: calc(100% * 9/16);
}

.sv-card-media-21x9 {
  padding-top: calc(100% * 9/21);
}

// Free aspect ratio (determined by content)
.sv-card-media-free {
  padding-top: 0;
}

/* ==========================================================================
   5. CARD MODIFIERS
   ========================================================================== */

// Card with dividers between all sections
.sv-card-dividers {
  .sv-card-header {
    border-bottom: 1px solid $card-header-border-color;
  }
  
  .sv-card-footer {
    border-top: 1px solid $card-footer-border-color;
  }
}

// Card with no dividers
.sv-card-no-dividers {
  .sv-card-header {
    border-bottom: none;
  }
  
  .sv-card-footer {
    border-top: none;
  }
}

// Card loading state
.sv-card-loading {
  pointer-events: none;
  position: relative;
  overflow: hidden;
  
  &::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, 
      rgba(255, 255, 255, 0) 0%, 
      rgba(255, 255, 255, 0.2) 50%, 
      rgba(255, 255, 255, 0) 100%);
    animation: shimmer 1.5s infinite;
    transform: translateX(-100%);
  }
  
  @keyframes shimmer {
    100% {
      transform: translateX(100%);
    }
  }
  
  .sv-card-body * {
    color: transparent !important;
    background-color: var(--sv-bg-element-hover) !important;
    border-color: transparent !important;
  }
}

// Card with scrollable content
.sv-card-scrollable {
  max-height: 400px;
  
  .sv-card-body {
    overflow-y: auto;
    max-height: 100%;
  }
}

/* ==========================================================================
   6. RESPONSIVE BEHAVIORS
   ========================================================================== */

// Responsive adjustments for small screens
@include breakpoint-down(sm) {
  .sv-card {
    .sv-card-header,
    .sv-card-body,
    .sv-card-footer {
      padding: var(--sv-padding-sm);
    }
    
    .sv-card-title {
      font-size: var(--sv-text-heading-sm);
    }
    
    .sv-card-subtitle {
      font-size: var(--sv-text-body-sm);
    }
  }
  
  // Stack horizontal card elements on small screens
  .sv-card-horizontal {
    flex-direction: column;
    
    .sv-card-media,
    .sv-card-content {
      width: 100%;
    }
  }
  
  // Adjust avatar size on small screens
  .sv-card-avatar {
    width: 32px;
    height: 32px;
  }
  
  // Adjust footer layout on small screens
  .sv-card-footer {
    flex-wrap: wrap;
    gap: var(--sv-space-sm);
    
    &.sv-card-footer-between {
      justify-content: center;
    }
  }
}

// Medium screens adjustments for horizontal cards
@include breakpoint-between(md, lg) {
  .sv-card-horizontal {
    .sv-card-media {
      width: 40%;
    }
    
    .sv-card-content {
      width: 60%;
    }
  }
}