/**
 * Menu Button Component - Specific Styles
 * Version: 1.1.0
 * Last Updated: June 30, 2024
 * 
 * This file establishes the specific styles for the menu button component
 * in the SkillVo design system. This serves as the third level in our 
 * three-tier styling architecture:
 * 1. sv-ui-control-base - Base styles for all interactive controls
 * 2. sv-action-control-base - Base styles for action controls
 * 3. sv-menu-button (this file) - Component-specific styles for menu buttons
 */

/* ==========================================================================
   TABLE OF CONTENTS:
   
   1. IMPORTS
   2. VARIABLES & CONFIGURATION
   3. MENU BUTTON BASE
   4. MENU BUTTON VARIANTS
   5. MENU BUTTON INDICATORS
   6. MENU BUTTON STATES
   7. MENU CONTAINER
   8. MENU ITEMS
   9. MENU ANIMATIONS
   ========================================================================== */

/* ==========================================================================
   1. IMPORTS
   ========================================================================== */
@use './../../abstracts/variables/' as *;
@use './../../base/utils/mixins/state' as state;
@use './../../base/utils/mixins/layout' as layout;
@use './../../base/utils/mixins/responsive' as responsive;

/* ==========================================================================
   2. VARIABLES & CONFIGURATION
   ========================================================================== */

// Menu button-specific variables
$menu-button-padding: var(--sv-space-2) var(--sv-space-3);
$menu-button-padding-minimal: var(--sv-space-1) var(--sv-space-2);
$menu-button-padding-icon: var(--sv-space-2);
$menu-button-min-width: var(--sv-min-touch-target);
$menu-button-gap: var(--sv-space-2);
$menu-button-indicator-margin: var(--sv-space-1);
$menu-button-indicator-size: 0.5em;
$menu-button-indicator-border-width: 0.1em;
$menu-button-indicator-font-size: 0.75em;
$menu-button-transition-duration: var(--sv-motion-duration-short);
$menu-button-transition-timing: var(--sv-motion-ease-standard);

// Menu container variables
$menu-z-index: var(--sv-z-index-dropdown);
$menu-bg-color: var(--sv-bg-surface);
$menu-border: 1px solid var(--sv-border-medium);
$menu-border-radius: var(--sv-radius-md);
$menu-box-shadow: var(--sv-shadow-md);
$menu-padding-y: var(--sv-space-1);
$menu-padding-x: 0;
$menu-margin-top: var(--sv-space-1);
$menu-max-height: calc(var(--sv-size-10) * 4);
$menu-section-padding: var(--sv-space-1) var(--sv-space-3);
$menu-section-font-size: var(--sv-text-xs);
$menu-section-font-weight: var(--sv-font-weight-semibold);
$menu-section-color: var(--sv-text-secondary);
$menu-section-margin-top: var(--sv-space-2);
$menu-divider-height: 1px;
$menu-divider-color: var(--sv-border-light);
$menu-divider-margin: var(--sv-space-1) 0;

/* ==========================================================================
   3. MENU BUTTON BASE
   ========================================================================== */

.sv-menu-button {
  // Extend the action control base to inherit all shared properties
  @extend .sv-action-control-base;
  
  // Menu button specific properties
  position: relative;
  
  // Customize spacing and layout
  padding: $menu-button-padding;
  
  // Display flex for proper alignment of text and icon
  display: inline-flex;
  align-items: center;
  justify-content: space-between;
  gap: $menu-button-gap;
  
  // Default indicator (chevron down)
  &::after {
    content: "";
    display: inline-block;
    width: $menu-button-indicator-size;
    height: $menu-button-indicator-size;
    border-style: solid;
    border-width: 0 $menu-button-indicator-border-width $menu-button-indicator-border-width 0;
    transform: rotate(45deg) translateY(-0.15em);
    transition: transform $menu-button-transition-duration $menu-button-transition-timing;
    margin-left: $menu-button-indicator-margin;
  }
}

/* ==========================================================================
   4. MENU BUTTON VARIANTS
   ========================================================================== */

.sv-menu-button {
  // Primary menu button
  &.sv-menu-button-primary {
    @extend .sv-action-primary;
  }
  
  // Secondary menu button
  &.sv-menu-button-secondary {
    @extend .sv-action-secondary;
  }
  
  // Tertiary menu button (ghost/text)
  &.sv-menu-button-tertiary {
    @extend .sv-action-tertiary;
  }
  
  // Minimal menu button (text only, no background)
  &.sv-menu-button-minimal {
    background-color: transparent;
    border-color: transparent;
    color: var(--sv-text-primary);
    padding: $menu-button-padding-minimal;
    min-width: auto;
    
    &:hover:not(:disabled):not(.disabled) {
      color: var(--sv-primary);
      background-color: transparent;
    }
    
    &:active:not(:disabled):not(.disabled) {
      color: var(--sv-primary-dark);
      transform: none;
    }
  }
  
  // Icon-only menu button
  &.sv-menu-button-icon {
    aspect-ratio: 1/1;
    padding: $menu-button-padding-icon;
    min-width: $menu-button-min-width;
    
    &::after {
      display: none;
    }
    
    > .sv-icon {
      margin: 0;
    }
  }
}

/* ==========================================================================
   5. MENU BUTTON INDICATORS
   ========================================================================== */

.sv-menu-button {
  // With custom indicator
  &.sv-menu-button-with-icon {
    &::after {
      display: none; // Hide default chevron
    }
    
    // Style for indicator icon
    .sv-menu-button-indicator {
      margin-left: $menu-button-indicator-margin;
      font-size: $menu-button-indicator-font-size;
      transition: transform $menu-button-transition-duration $menu-button-transition-timing;
    }
  }
  
  // No indicator
  &.sv-menu-button-no-indicator {
    &::after {
      display: none;
    }
  }
}

/* ==========================================================================
   6. MENU BUTTON STATES
   ========================================================================== */

.sv-menu-button {
  // Open state (when menu is visible)
  &[aria-expanded="true"] {
    // Rotate default indicator
    &::after {
      transform: rotate(-135deg) translateX(0.15em);
    }
    
    // Rotate custom indicator icon
    .sv-menu-button-indicator {
      transform: rotate(180deg);
    }
    
    // Style changes in open state
    z-index: calc($menu-z-index + 1);
    
    // Specific to button variants
    &.sv-menu-button-minimal {
      color: var(--sv-primary);
    }
  }
}

/* ==========================================================================
   7. MENU CONTAINER
   ========================================================================== */

.sv-menu {
  position: absolute;
  z-index: $menu-z-index;
  min-width: 100%;
  background-color: $menu-bg-color;
  border: $menu-border;
  border-radius: $menu-border-radius;
  box-shadow: $menu-box-shadow;
  padding: $menu-padding-y $menu-padding-x;
  margin: 0;
  list-style: none;
  overflow: hidden;
  max-height: $menu-max-height;
  overflow-y: auto;
  
  // Default position (bottom)
  top: 100%;
  left: 0;
  margin-top: $menu-margin-top;
  
  // Top position
  &.sv-menu-top {
    top: auto;
    bottom: 100%;
    margin-top: 0;
    margin-bottom: $menu-margin-top;
  }
  
  // Right position (menu opens to the right)
  &.sv-menu-right {
    left: auto;
    right: 0;
  }
  
  // Center position
  &.sv-menu-center {
    left: 50%;
    transform: translateX(-50%);
  }
  
  // Full width
  &.sv-menu-full-width {
    width: 100%;
  }
  
  // Custom width
  &.sv-menu-custom-width {
    width: var(--sv-menu-width, 200px);
  }
  
  // Menu with section headers
  .sv-menu-section {
    padding: $menu-section-padding;
    font-size: $menu-section-font-size;
    font-weight: $menu-section-font-weight;
    color: $menu-section-color;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-top: $menu-section-margin-top;
    
    &:first-child {
      margin-top: 0;
    }
  }
  
  // Menu divider
  .sv-menu-divider {
    height: $menu-divider-height;
    background-color: $menu-divider-color;
    margin: $menu-divider-margin;
  }
}

/* ==========================================================================
   8. MENU ITEMS
   ========================================================================== */

.sv-menu-item {
  display: flex;
  align-items: center;
  padding: var(--sv-space-2) var(--sv-space-3);
  color: var(--sv-text-primary);
  cursor: pointer;
  font-size: var(--sv-text-sm);
  white-space: nowrap;
  
  // Icon alignment
  .sv-menu-item-icon {
    margin-right: var(--sv-space-2);
    font-size: 1.2em;
    color: var(--sv-text-secondary);
    flex-shrink: 0;
  }
  
  // Item with description
  .sv-menu-item-content {
    display: flex;
    flex-direction: column;
    flex: 1;
    
    .sv-menu-item-description {
      font-size: var(--sv-text-xs);
      color: var(--sv-text-secondary);
      margin-top: var(--sv-space-1);
    }
  }
  
  // Right side elements (shortcut, badge, etc.)
  .sv-menu-item-meta {
    margin-left: var(--sv-space-3);
    font-size: var(--sv-text-xs);
    color: var(--sv-text-secondary);
  }
  
  // Hover state
  &:hover {
    background-color: var(--sv-bg-element-hover);
    color: var(--sv-text-accent);
    
    .sv-menu-item-icon {
      color: var(--sv-primary);
    }
  }
  
  // Active state
  &:active {
    background-color: var(--sv-bg-element-active);
  }
  
  // Selected state
  &.sv-menu-item-selected {
    background-color: var(--sv-bg-element-selected);
    color: var(--sv-primary);
    font-weight: var(--sv-font-medium);
    
    .sv-menu-item-icon {
      color: var(--sv-primary);
    }
  }
  
  // Disabled state
  &.sv-menu-item-disabled {
    color: var(--sv-text-disabled);
    pointer-events: none;
    cursor: default;
    
    .sv-menu-item-icon, 
    .sv-menu-item-description, 
    .sv-menu-item-meta {
      color: var(--sv-text-disabled);
    }
  }
  
  // Destructive action
  &.sv-menu-item-destructive {
    color: var(--sv-error);
    
    &:hover {
      background-color: rgba(var(--sv-error-500-rgb), 0.1);
    }
    
    .sv-menu-item-icon {
      color: var(--sv-error);
    }
  }
}

/* ==========================================================================
   9. MENU ANIMATIONS
   ========================================================================== */

// Menu animation options
.sv-menu {
  // Fade animation
  &.sv-menu-fade {
    opacity: 0;
    transition: opacity var(--sv-motion-duration-short) var(--sv-motion-ease-standard);
    
    &.sv-menu-open {
      opacity: 1;
    }
  }
  
  // Scale animation
  &.sv-menu-scale {
    transform-origin: top center;
    transform: scale(0.95);
    opacity: 0;
    transition: transform var(--sv-motion-duration-short) var(--sv-motion-ease-standard),
                opacity var(--sv-motion-duration-short) var(--sv-motion-ease-standard);
    
    &.sv-menu-open {
      transform: scale(1);
      opacity: 1;
    }
    
    // Adjust origin based on position
    &.sv-menu-top {
      transform-origin: bottom center;
    }
    
    &.sv-menu-right {
      transform-origin: top right;
    }
  }
  
  // Slide animation
  &.sv-menu-slide {
    transform: translateY(-10px);
    opacity: 0;
    transition: transform var(--sv-motion-duration-short) var(--sv-motion-ease-standard),
                opacity var(--sv-motion-duration-short) var(--sv-motion-ease-standard);
    
    &.sv-menu-open {
      transform: translateY(0);
      opacity: 1;
    }
    
    // Adjust slide direction based on position
    &.sv-menu-top {
      transform: translateY(10px);
    }
  }
  
  // Respect reduced motion preferences
  @media (prefers-reduced-motion: reduce) {
    &.sv-menu-fade, 
    &.sv-menu-scale,
    &.sv-menu-slide {
      transition: none;
      opacity: 1;
      transform: none;
    }
  }
}