/**
 * Split Button Component - Specific Styles
 * Version: 1.1.0
 * Last Updated: June 30, 2024
 * 
 * This file establishes the specific styles for the split button component
 * in the SkillVo design system. This serves as the third level in our 
 * three-tier styling architecture:
 * 1. sv-ui-control-base - Base styles for all interactive controls
 * 2. sv-action-control-base - Base styles for action controls
 * 3. sv-split-button (this file) - Component-specific styles for split buttons
 */

/* ==========================================================================
   TABLE OF CONTENTS:
   
   1. IMPORTS
   2. VARIABLES & CONFIGURATION
   3. SPLIT BUTTON CONTAINER
   4. SPLIT BUTTON PARTS
   5. SPLIT BUTTON VARIANTS
   6. SPLIT BUTTON STATES
   7. SPLIT BUTTON DROPDOWN
   8. SPLIT BUTTON SIZES
   9. SPLIT BUTTON ANIMATIONS
   ========================================================================== */

/* ==========================================================================
   1. IMPORTS
   ========================================================================== */
@use './../../abstracts' as *;
@use './../../base/' as *;
@use './../../base/utils/mixins/state' as state;
@use './../../base/utils/mixins/layout' as layout;
@use './../../base/utils/mixins/responsive' as responsive;

/* ==========================================================================
   2. VARIABLES & CONFIGURATION
   ========================================================================== */

// Split button-specific variables
$split-button-border-collapse: -1px;
$split-button-toggle-padding: var(--sv-space-1) var(--sv-space-2);
$split-button-toggle-padding-sm: var(--sv-space-1) var(--sv-space-1);
$split-button-toggle-padding-lg: var(--sv-space-2) var(--sv-space-3);
$split-button-action-padding-sm: var(--sv-space-1) var(--sv-space-2);
$split-button-action-padding-lg: var(--sv-space-3) var(--sv-space-4);
$split-button-indicator-size: 0.5em;
$split-button-indicator-size-sm: 0.4em;
$split-button-indicator-size-lg: 0.6em;
$split-button-indicator-border-width: 0.1em;
$split-button-transition-duration: var(--sv-motion-duration-short);
$split-button-transition-timing: var(--sv-motion-ease-standard);
$split-button-separator-color-light: rgba(255, 255, 255, 0.2);
$split-button-menu-margin-top: var(--sv-space-1);
$split-button-font-size-sm: var(--sv-text-sm);
$split-button-font-size-lg: var(--sv-text-lg);

/* ==========================================================================
   3. SPLIT BUTTON CONTAINER
   ========================================================================== */

.sv-split-button {
  // Container for both parts of the split button
  position: relative;
  display: inline-flex;
  vertical-align: middle;
  
  // Proper spacing for the two parts
  .sv-split-button-action,
  .sv-split-button-toggle {
    position: relative;
  }
  
  // Remove radius between adjacent parts
  .sv-split-button-action {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    margin-right: $split-button-border-collapse; // Border collapse
  }
  
  .sv-split-button-toggle {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }
}

/* ==========================================================================
   4. SPLIT BUTTON PARTS
   ========================================================================== */

.sv-split-button {
  // Main action button
  .sv-split-button-action {
    @extend .sv-action-control-base;
    min-width: auto;
    
    // Prevent jumping on active state
    &:active:not(:disabled):not(.disabled) {
      transform: none;
    }
  }
  
  // Toggle button (dropdown)
  .sv-split-button-toggle {
    @extend .sv-action-control-base;
    padding: $split-button-toggle-padding;
    min-width: auto;
    
    // Chevron indicator
    &::after {
      content: "";
      display: inline-block;
      width: $split-button-indicator-size;
      height: $split-button-indicator-size;
      border-style: solid;
      border-width: 0 $split-button-indicator-border-width $split-button-indicator-border-width 0;
      transform: rotate(45deg) translateY(-0.15em);
      transition: transform $split-button-transition-duration $split-button-transition-timing;
    }
    
    // Prevent jumping on active state
    &:active:not(:disabled):not(.disabled) {
      transform: none;
    }
  }
}

/* ==========================================================================
   5. SPLIT BUTTON VARIANTS
   ========================================================================== */

.sv-split-button {
  // Primary split button
  &.sv-split-button-primary {
    .sv-split-button-action,
    .sv-split-button-toggle {
      @extend .sv-action-primary;
    }
    
    // Border between the parts
    .sv-split-button-toggle {
      border-left-color: $split-button-separator-color-light;
    }
  }
  
  // Secondary split button
  &.sv-split-button-secondary {
    .sv-split-button-action,
    .sv-split-button-toggle {
      @extend .sv-action-secondary;
    }
  }
  
  // Tertiary split button
  &.sv-split-button-tertiary {
    .sv-split-button-action,
    .sv-split-button-toggle {
      @extend .sv-action-tertiary;
    }
  }
  
  // Destructive split button
  &.sv-split-button-destructive {
    .sv-split-button-action,
    .sv-split-button-toggle {
      @extend .sv-action-destructive;
    }
    
    // Border between the parts
    .sv-split-button-toggle {
      border-left-color: $split-button-separator-color-light;
    }
  }
  
  // Outline split button
  &.sv-split-button-outline {
    .sv-split-button-action,
    .sv-split-button-toggle {
      background-color: transparent;
      border-color: var(--sv-primary);
      color: var(--sv-primary);
      
      &:hover:not(:disabled):not(.disabled) {
        background-color: rgba(var(--sv-primary-rgb), 0.05);
      }
      
      &:active:not(:disabled):not(.disabled) {
        background-color: rgba(var(--sv-primary-rgb), 0.1);
      }
    }
  }
}

/* ==========================================================================
   6. SPLIT BUTTON STATES
   ========================================================================== */

.sv-split-button {
  // Focused state (highlight the focused part)
  .sv-split-button-action:focus,
  .sv-split-button-toggle:focus {
    z-index: 1;
  }
  
  // Hover state (highlight the hovered part)
  .sv-split-button-action:hover,
  .sv-split-button-toggle:hover {
    z-index: 2;
  }
  
  // Expanded state (dropdown open)
  .sv-split-button-toggle[aria-expanded="true"] {
    z-index: 3;
    
    // Rotate chevron
    &::after {
      transform: rotate(-135deg) translateX(0.2em);
    }
  }
  
  // Disabled state
  &.disabled,
  &:disabled {
    .sv-split-button-action,
    .sv-split-button-toggle {
      pointer-events: none;
      opacity: var(--sv-opacity-disabled);
    }
  }
}

/* ==========================================================================
   7. SPLIT BUTTON DROPDOWN
   ========================================================================== */

.sv-split-button {
  // Menu positioning
  .sv-menu {
    min-width: 100%;
    top: 100%;
    right: 0;
    margin-top: $split-button-menu-margin-top;
    
    // Full width if menu should match the button width
    &.sv-menu-full-width {
      width: 100%;
    }
  }
}

/* ==========================================================================
   8. SPLIT BUTTON SIZES
   ========================================================================== */

.sv-split-button {
  // Small size
  &.sv-size-sm {
    .sv-split-button-action {
      padding: $split-button-action-padding-sm;
      font-size: $split-button-font-size-sm;
    }
    
    .sv-split-button-toggle {
      padding: $split-button-toggle-padding-sm;
      
      &::after {
        width: $split-button-indicator-size-sm;
        height: $split-button-indicator-size-sm;
      }
    }
  }
  
  // Large size
  &.sv-size-lg {
    .sv-split-button-action {
      padding: $split-button-action-padding-lg;
      font-size: $split-button-font-size-lg;
    }
    
    .sv-split-button-toggle {
      padding: $split-button-toggle-padding-lg;
      
      &::after {
        width: $split-button-indicator-size-lg;
        height: $split-button-indicator-size-lg;
      }
    }
  }
}

/* ==========================================================================
   9. SPLIT BUTTON ANIMATIONS
   ========================================================================== */

.sv-split-button {
  // Ripple effect
  &.sv-split-button-with-ripple {
    .sv-split-button-action,
    .sv-split-button-toggle {
      position: relative;
      overflow: hidden;
      
      &::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: radial-gradient(circle, rgba(255, 255, 255, 0.3) 0%, transparent 70%);
        transform: scale(0);
        opacity: 0;
        pointer-events: none;
        transition: transform 0.3s, opacity 0.3s;
      }
      
      &:active::before {
        transform: scale(3);
        opacity: 1;
        transition: 0s;
      }
    }
  }
  
  // Respect reduced motion preferences
  @media (prefers-reduced-motion: reduce) {
    &.sv-split-button-with-ripple {
      .sv-split-button-action,
      .sv-split-button-toggle {
        &::before {
          transition: none;
        }
      }
    }
  }
}