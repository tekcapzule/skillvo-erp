/**
 * Icon Button Component - Specific Styles
 * Version: 1.1.0
 * Last Updated: June 30, 2024
 * 
 * This file establishes the specific styles for the icon button component
 * in the SkillVo design system. This serves as the third level in our 
 * three-tier styling architecture:
 * 1. sv-ui-control-base - Base styles for all interactive controls
 * 2. sv-action-control-base - Base styles for action controls
 * 3. sv-icon-button (this file) - Component-specific styles for icon buttons
 */

/* ==========================================================================
   TABLE OF CONTENTS:
   
   1. IMPORTS
   2. ICON BUTTON BASE
   3. ICON BUTTON VARIANTS
   4. ICON BUTTON SIZES
   5. ICON BUTTON WITH BADGE/INDICATOR
   6. ACCESSIBILITY ENHANCEMENTS
   ========================================================================== */

/* ==========================================================================
   1. IMPORTS
   ========================================================================== */
@use './../../abstracts/' as *;
@use './../../base/' as *;

/* ==========================================================================
   2. ICON BUTTON BASE
   ========================================================================== */

.sv-icon-button {
  // Extend the action control base to inherit all shared properties
  @extend .sv-action-control-base;
  
  // Make icon buttons square by default
  aspect-ratio: 1/1;
  padding: var(--sv-space-2);
  
  // Special styling for icons within the button
  > .sv-icon {
    flex-shrink: 0;
    width: var(--sv-icon-size-md);
    height: var(--sv-icon-size-md);
  }
  
  // Override the base control's hover state
  &:hover:not(:disabled):not(.disabled) {
    transform: scale(1.05);
  }
  
  // Override the base control's active state
  &:active:not(:disabled):not(.disabled) {
    transform: scale(0.95);
  }
}

/* ==========================================================================
   3. ICON BUTTON VARIANTS
   ========================================================================== */

.sv-icon-button {
  // Apply the same variant styles as regular buttons
  &.sv-icon-button-primary {
    @extend .sv-action-primary;
  }
  
  &.sv-icon-button-secondary {
    @extend .sv-action-secondary;
  }
  
  &.sv-icon-button-tertiary {
    @extend .sv-action-tertiary;
  }
  
  &.sv-icon-button-destructive {
    @extend .sv-action-destructive;
  }
  
  // Ghost icon button (transparent background)
  &.sv-icon-button-ghost {
    background-color: transparent;
    border-color: transparent;
    color: var(--sv-text-primary);
    
    &:hover:not(:disabled):not(.disabled) {
      background-color: var(--sv-bg-element-hover);
      color: var(--sv-primary);
    }
    
    &:active:not(:disabled):not(.disabled) {
      background-color: var(--sv-bg-element-active);
    }
  }
  
  // Subtle icon button (very light background)
  &.sv-icon-button-subtle {
    background-color: var(--sv-bg-element-light);
    border-color: transparent;
    color: var(--sv-text-primary);
    
    &:hover:not(:disabled):not(.disabled) {
      background-color: var(--sv-bg-element-hover);
      color: var(--sv-text-accent);
    }
  }
  
  // Circular icon button
  &.sv-icon-button-circular {
    border-radius: var(--sv-radius-full);
  }
}

/* ==========================================================================
   4. ICON BUTTON SIZES
   ========================================================================== */

.sv-icon-button {
  // Small size icon button
  &.sv-size-sm {
    padding: var(--sv-space-1);
    
    > .sv-icon {
      width: var(--sv-icon-size-sm);
      height: var(--sv-icon-size-sm);
    }
  }
  
  // Large size icon button
  &.sv-size-lg {
    padding: var(--sv-space-3);
    
    > .sv-icon {
      width: var(--sv-icon-size-lg);
      height: var(--sv-icon-size-lg);
    }
  }
}

/* ==========================================================================
   5. ICON BUTTON WITH BADGE/INDICATOR
   ========================================================================== */

.sv-icon-button {
  // Icon button with notification badge
  &.sv-icon-button-with-badge {
    position: relative;
    
    .sv-badge {
      position: absolute;
      top: 0;
      right: 0;
      transform: translate(25%, -25%);
      z-index: 1;
    }
  }
  
  // Icon button with status indicator (dot)
  &.sv-icon-button-with-status {
    position: relative;
    
    &::after {
      content: "";
      position: absolute;
      width: var(--sv-size-2);
      height: var(--sv-size-2);
      border-radius: var(--sv-radius-full);
      background-color: currentColor;
      top: var(--sv-space-1);
      right: var(--sv-space-1);
    }
    
    &.sv-status-success::after {
      background-color: var(--sv-success);
    }
    
    &.sv-status-error::after {
      background-color: var(--sv-error);
    }
    
    &.sv-status-warning::after {
      background-color: var(--sv-warning);
    }
    
    &.sv-status-info::after {
      background-color: var(--sv-info);
    }
  }
}

/* ==========================================================================
   6. ACCESSIBILITY ENHANCEMENTS
   ========================================================================== */

.sv-icon-button {
  // Ensure proper focus visibility for icon buttons
  &:focus-visible {
    outline: var(--sv-focus-ring-width) solid var(--sv-focus-ring-color);
    outline-offset: var(--sv-focus-ring-offset);
  }
  
  // Enhanced keyboard focus indication
  &.sv-focus-enhanced:focus-visible {
    box-shadow: 0 0 0 var(--sv-focus-ring-width) var(--sv-focus-ring-color);
  }
  
  // Include text label for screen readers when needed
  &.sv-a11y-has-label {
    position: relative;
    
    .sv-a11y-label {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border-width: 0;
    }
  }
  
  // Provide additional tooltip on hover for context
  &[title] {
    position: relative;
    
    &:hover::before {
      content: attr(title);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      padding: var(--sv-space-1) var(--sv-space-2);
      background-color: var(--sv-bg-tooltip);
      color: var(--sv-text-on-dark);
      border-radius: var(--sv-radius-sm);
      font-size: var(--sv-text-xs);
      white-space: nowrap;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s;
      z-index: var(--sv-z-index-tooltip);
    }
    
    @media (prefers-reduced-motion: no-preference) {
      &:hover::before {
        opacity: 1;
        transition-delay: 0.5s;
      }
    }
  }
}