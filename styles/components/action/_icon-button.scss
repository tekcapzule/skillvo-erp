/**
 * Icon Button Component - Specific Styles
 * Version: 1.1.0
 * Last Updated: June 30, 2024
 * 
 * This file establishes the specific styles for the icon button component
 * in the SkillVo design system. This serves as the third level in our 
 * three-tier styling architecture:
 * 1. sv-ui-control-base - Base styles for all interactive controls
 * 2. sv-action-control-base - Base styles for action controls
 * 3. sv-icon-button (this file) - Component-specific styles for icon buttons
 */

/* ==========================================================================
   TABLE OF CONTENTS:
   
   1. IMPORTS
   2. VARIABLES & CONFIGURATION
   3. ICON BUTTON BASE
   4. ICON BUTTON VARIANTS
   5. ICON BUTTON SIZES
   6. ICON BUTTON WITH BADGE/INDICATOR
   7. ACCESSIBILITY ENHANCEMENTS
   ========================================================================== */

/* ==========================================================================
   1. IMPORTS
   ========================================================================== */
@use './../../abstracts' as *;
@use './../../base/' as *;
@use './../../base/utils/mixins/state' as state;
@use './../../base/utils/mixins/layout' as layout;
@use './../../base/utils/mixins/responsive' as responsive;

/* ==========================================================================
   2. VARIABLES & CONFIGURATION
   ========================================================================== */

// Icon button-specific variables
$icon-button-padding: var(--sv-space-2);
$icon-button-padding-sm: var(--sv-space-1);
$icon-button-padding-lg: var(--sv-space-3);
$icon-button-icon-size: var(--sv-icon-size-md);
$icon-button-icon-size-sm: var(--sv-icon-size-sm);
$icon-button-icon-size-lg: var(--sv-icon-size-lg);
$icon-button-hover-scale: 1.05;
$icon-button-active-scale: 0.95;
$icon-button-status-size: var(--sv-size-2);
$icon-button-status-position: var(--sv-space-1);
$icon-button-focus-outline-width: var(--sv-focus-ring-width);
$icon-button-focus-outline-color: var(--sv-focus-ring-color);
$icon-button-focus-outline-offset: var(--sv-focus-ring-offset);
$icon-button-tooltip-padding: var(--sv-space-1) var(--sv-space-2);
$icon-button-tooltip-font-size: var(--sv-text-xs);

/* ==========================================================================
   3. ICON BUTTON BASE
   ========================================================================== */

.sv-icon-button {
  // Extend the action control base to inherit all shared properties
  @extend .sv-action-control-base;
  
  // Make icon buttons square by default
  aspect-ratio: 1/1;
  padding: $icon-button-padding;
  
  // Special styling for icons within the button
  > .sv-icon {
    flex-shrink: 0;
    width: $icon-button-icon-size;
    height: $icon-button-icon-size;
  }
  
  // Override the base control's hover state
  &:hover:not(:disabled):not(.disabled) {
    transform: scale($icon-button-hover-scale);
  }
  
  // Override the base control's active state
  &:active:not(:disabled):not(.disabled) {
    transform: scale($icon-button-active-scale);
  }
}

/* ==========================================================================
   4. ICON BUTTON VARIANTS
   ========================================================================== */

.sv-icon-button {
  // Apply the same variant styles as regular buttons
  &.sv-icon-button-primary {
    @extend .sv-action-primary;
  }
  
  &.sv-icon-button-secondary {
    @extend .sv-action-secondary;
  }
  
  &.sv-icon-button-tertiary {
    @extend .sv-action-tertiary ;
  }
  
  &.sv-icon-button-destructive {
    @extend .sv-action-destructive;
  }
  
  // Ghost icon button (transparent background)
  &.sv-icon-button-ghost {
    background-color: transparent;
    border-color: transparent;
    color: var(--sv-text-primary);
    
    &:hover:not(:disabled):not(.disabled) {
      background-color: var(--sv-bg-element-hover);
      color: var(--sv-primary);
    }
    
    &:active:not(:disabled):not(.disabled) {
      background-color: var(--sv-bg-element-active);
    }
  }
  
  // Subtle icon button (very light background)
  &.sv-icon-button-subtle {
    background-color: var(--sv-bg-element-light);
    border-color: transparent;
    color: var(--sv-text-primary);
    
    &:hover:not(:disabled):not(.disabled) {
      background-color: var(--sv-bg-element-hover);
      color: var(--sv-text-accent);
    }
  }
  
  // Circular icon button
  &.sv-icon-button-circular {
    border-radius: var(--sv-radius-full);
  }
}

/* ==========================================================================
   5. ICON BUTTON SIZES
   ========================================================================== */

.sv-icon-button {
  // Small size icon button
  &.sv-size-sm {
    padding: $icon-button-padding-sm;
    
    > .sv-icon {
      width: $icon-button-icon-size-sm;
      height: $icon-button-icon-size-sm;
    }
  }
  
  // Large size icon button
  &.sv-size-lg {
    padding: $icon-button-padding-lg;
    
    > .sv-icon {
      width: $icon-button-icon-size-lg;
      height: $icon-button-icon-size-lg;
    }
  }
}

/* ==========================================================================
   6. ICON BUTTON WITH BADGE/INDICATOR
   ========================================================================== */

.sv-icon-button {
  // Icon button with notification badge
  &.sv-icon-button-with-badge {
    position: relative;
    
    .sv-badge {
      position: absolute;
      top: 0;
      right: 0;
      transform: translate(25%, -25%);
      z-index: 1;
    }
  }
  
  // Icon button with status indicator (dot)
  &.sv-icon-button-with-status {
    position: relative;
    
    &::after {
      content: "";
      position: absolute;
      width: $icon-button-status-size;
      height: $icon-button-status-size;
      border-radius: var(--sv-radius-full);
      background-color: currentColor;
      top: $icon-button-status-position;
      right: $icon-button-status-position;
    }
    
    &.sv-status-success::after {
      background-color: var(--sv-success);
    }
    
    &.sv-status-error::after {
      background-color: var(--sv-error);
    }
    
    &.sv-status-warning::after {
      background-color: var(--sv-warning);
    }
    
    &.sv-status-info::after {
      background-color: var(--sv-info);
    }
  }
}

/* ==========================================================================
   7. ACCESSIBILITY ENHANCEMENTS
   ========================================================================== */

.sv-icon-button {
  // Ensure proper focus visibility for icon buttons
  &:focus-visible {
    outline: $icon-button-focus-outline-width solid $icon-button-focus-outline-color;
    outline-offset: $icon-button-focus-outline-offset;
  }
  
  // Enhanced keyboard focus indication
  &.sv-focus-enhanced:focus-visible {
    box-shadow: 0 0 0 $icon-button-focus-outline-width $icon-button-focus-outline-color;
  }
  
  // Include text label for screen readers when needed
  &.sv-a11y-has-label {
    position: relative;
    
    .sv-a11y-label {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border-width: 0;
    }
  }
  
  // Provide additional tooltip on hover for context
  &[title] {
    position: relative;
    
    &:hover::before {
      content: attr(title);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      padding: $icon-button-tooltip-padding;
      background-color: var(--sv-bg-tooltip);
      color: var(--sv-text-on-dark);
      border-radius: var(--sv-radius-sm);
      font-size: $icon-button-tooltip-font-size;
      white-space: nowrap;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s;
      z-index: var(--sv-z-index-tooltip);
    }
    
    @media (prefers-reduced-motion: no-preference) {
      &:hover::before {
        opacity: 1;
        transition-delay: 0.5s;
      }
    }
  }
}