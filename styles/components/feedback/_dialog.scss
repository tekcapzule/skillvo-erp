/**
 * Dialog Component - Specific Styles
 * Version: 2.0.0
 * Last Updated: July 3, 2024
 * 
 * This file establishes the specific styles for the dialog component
 * in the SkillVo design system. This serves as the third level in our 
 * three-tier styling architecture:
 * 1. sv-ui-control-base - Base styles for all interactive controls
 * 2. sv-feedback-control-base - Base styles for feedback controls
 * 3. sv-dialog (this file) - Component-specific styles for dialogs
 */

/* ==========================================================================
   TABLE OF CONTENTS:
   
   1. IMPORTS
   2. VARIABLES & CONFIGURATION
   3. DIALOG BASE
   4. DIALOG PARTS (HEADER, BODY, FOOTER)
   5. DIALOG SIZES
   6. DIALOG VARIANTS 
   7. DIALOG ANIMATIONS
   8. DIALOG BACKDROP
   9. RESPONSIVE ADAPTATIONS
   10. ACCESSIBILITY ENHANCEMENTS
   ========================================================================== */

/* ==========================================================================
   1. IMPORTS
   ========================================================================== */
@use './../../abstracts/variables/' as *;
@use './../../base/utils/mixins/state' as state;
@use './../../base/utils/mixins/layout' as layout;
@use './../../base/utils/mixins/typography' as typography;
@use './../../base/utils/mixins/responsive' as responsive;
@use './../../base/utils/mixins/accessibility' as a11y;

/* ==========================================================================
   2. VARIABLES & CONFIGURATION
   ========================================================================== */

// Dialog-specific dimensions
$dialog-sm-width: 400px;
$dialog-md-width: 600px;
$dialog-lg-width: 800px;
$dialog-xl-width: 1000px;
$dialog-border-width: 1px;
$dialog-border-radius: var(--sv-radius-md);

// Dialog-specific spacing
$dialog-padding-x: var(--sv-space-6);
$dialog-padding-y: var(--sv-space-5);
$dialog-header-padding-y: var(--sv-space-4);
$dialog-footer-padding-y: var(--sv-space-4);
$dialog-body-padding-y: var(--sv-space-5);

// Dialog-specific animation
$dialog-animation-duration: var(--sv-motion-duration-medium);
$dialog-transition-timing: var(--sv-motion-ease-standard);

// Dialog z-index (should be higher than other components)
$dialog-z-index: var(--sv-z-index-modal);
$dialog-backdrop-z-index: calc(#{$dialog-z-index} - 1);

/* ==========================================================================
   3. DIALOG BASE
   ========================================================================== */

.sv-dialog {
  // Extend the feedback control base to inherit all shared properties
  @extend .sv-feedback-control-base;
  
  // Dialog-specific layout and spacing
  padding: 0; // Padding managed by child elements
  
  // Structural styles
  position: fixed;
  z-index: $dialog-z-index;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: none;
  border-width: $dialog-border-width;
  border-style: solid;
  border-radius: $dialog-border-radius;
  box-sizing: border-box;
  overflow: hidden;
  
  // Default size
  width: $dialog-md-width;
  max-width: calc(100vw - var(--sv-space-6));
  
  // Visual styling
  background-color: var(--sv-bg-surface);
  border-color: var(--sv-border-medium);
  box-shadow: var(--sv-shadow-xl);
  
  // Focus handling
  &:focus {
    outline: none;
  }
  
  &:focus-visible {
    @include state.focus-visible-state;
  }
  
  // Transitions
  transition: transform $dialog-animation-duration $dialog-transition-timing,
              opacity $dialog-animation-duration $dialog-transition-timing;
}

/* ==========================================================================
   4. DIALOG PARTS (HEADER, BODY, FOOTER)
   ========================================================================== */

.sv-dialog {
  // Dialog header
  &__header {
    padding: $dialog-header-padding-y $dialog-padding-x;
    border-bottom: $dialog-border-width solid var(--sv-border-light);
    position: relative;
  }
  
  // Dialog title
  &__title {
    font-size: var(--sv-font-size-xl);
    font-weight: var(--sv-font-weight-semibold);
    line-height: var(--sv-line-height-normal);
    margin: 0;
  }
  
  // Dialog subtitle
  &__subtitle {
    font-size: var(--sv-font-size-base);
    font-weight: var(--sv-font-weight-normal);
    line-height: var(--sv-line-height-normal);
    color: var(--sv-text-secondary);
    margin: var(--sv-space-2) 0 0 0;
  }
  
  // Close button
  &__close {
    position: absolute;
    top: $dialog-header-padding-y;
    right: $dialog-padding-x;
    background: transparent;
    border: none;
    padding: 0;
    margin: 0;
    cursor: pointer;
    width: var(--sv-icon-size-md);
    height: var(--sv-icon-size-md);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    color: var(--sv-text-secondary);
    transition: color var(--sv-motion-duration-short) $dialog-transition-timing,
                background-color var(--sv-motion-duration-short) $dialog-transition-timing;
    border-radius: var(--sv-radius-sm);
    
    &:hover {
      color: var(--sv-text-primary);
      background-color: var(--sv-bg-element-hover);
    }
    
    &:focus-visible {
      @include state.focus-visible-state;
    }
  }
  
  // Dialog body
  &__body {
    padding: $dialog-body-padding-y $dialog-padding-x;
    font-size: var(--sv-font-size-base);
    font-weight: var(--sv-font-weight-normal);
    line-height: var(--sv-line-height-normal);
  }
  
  // Dialog footer
  &__footer {
    padding: $dialog-footer-padding-y $dialog-padding-x;
    border-top: $dialog-border-width solid var(--sv-border-light);
  }
  
  // Actions container
  &__actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--sv-space-3);
    
    &--center {
      justify-content: center;
    }
    
    &--between {
      justify-content: space-between;
    }
    
    &--start {
      justify-content: flex-start;
    }
  }
}

/* ==========================================================================
   5. DIALOG SIZES
   ========================================================================== */

.sv-dialog {
  // Small dialog
  &--sm {
    width: $dialog-sm-width;
    max-width: calc(100vw - var(--sv-space-6));
  }
  
  // Medium dialog (default)
  &--md {
    width: $dialog-md-width;
    max-width: calc(100vw - var(--sv-space-6));
  }
  
  // Large dialog
  &--lg {
    width: $dialog-lg-width;
    max-width: calc(100vw - var(--sv-space-6));
  }
  
  // Extra large dialog
  &--xl {
    width: $dialog-xl-width;
    max-width: calc(100vw - var(--sv-space-6));
  }
  
  // Full-screen dialog
  &--full {
    width: calc(100vw - var(--sv-space-6));
    height: calc(100vh - var(--sv-space-6));
  }
}

/* ==========================================================================
   6. DIALOG VARIANTS 
   ========================================================================== */

.sv-dialog {
  // Info variant
  &--info {
    .sv-dialog__header {
      background-color: rgba(var(--sv-info-rgb), 0.1);
      color: var(--sv-info);
      border-bottom-color: var(--sv-info);
    }
  }
  
  // Success variant
  &--success {
    .sv-dialog__header {
      background-color: rgba(var(--sv-success-rgb), 0.1);
      color: var(--sv-success);
      border-bottom-color: var(--sv-success);
    }
  }
  
  // Warning variant
  &--warning {
    .sv-dialog__header {
      background-color: rgba(var(--sv-warning-rgb), 0.1);
      color: var(--sv-warning);
      border-bottom-color: var(--sv-warning);
    }
  }
  
  // Error variant
  &--error {
    .sv-dialog__header {
      background-color: rgba(var(--sv-error-rgb), 0.1);
      color: var(--sv-error);
      border-bottom-color: var(--sv-error);
    }
  }
  
  // Primary variant
  &--primary {
    .sv-dialog__header {
      background-color: var(--sv-primary);
      color: var(--sv-text-on-dark);
      border-bottom-color: var(--sv-primary);
      
      .sv-dialog__close {
        color: var(--sv-text-on-dark);
        
        &:hover {
          background-color: rgba(255, 255, 255, 0.1);
        }
      }
      
      .sv-dialog__subtitle {
        color: rgba(255, 255, 255, 0.8);
      }
    }
  }
  
  // Borderless variant
  &--borderless {
    border: none;
    
    .sv-dialog__header {
      border-bottom: none;
    }
    
    .sv-dialog__footer {
      border-top: none;
    }
  }
}

/* ==========================================================================
   7. DIALOG ANIMATIONS
   ========================================================================== */

@keyframes sv-dialog-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes sv-dialog-fade-out {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

@keyframes sv-dialog-slide-in {
  from {
    transform: translate(-50%, -60%);
    opacity: 0;
  }
  to {
    transform: translate(-50%, -50%);
    opacity: 1;
  }
}

@keyframes sv-dialog-slide-out {
  from {
    transform: translate(-50%, -50%);
    opacity: 1;
  }
  to {
    transform: translate(-50%, -60%);
    opacity: 0;
  }
}

.sv-dialog {
  &.is-entering {
    animation: sv-dialog-slide-in $dialog-animation-duration $dialog-transition-timing;
    display: block;
  }
  
  &.is-exiting {
    animation: sv-dialog-slide-out $dialog-animation-duration $dialog-transition-timing;
    display: block;
  }
  
  &.is-visible {
    display: block;
  }
  
  // Side entry animation
  &--side-entry {
    &.is-entering {
      animation: sv-dialog-side-entry $dialog-animation-duration $dialog-transition-timing;
    }
    
    &.is-exiting {
      animation: sv-dialog-side-exit $dialog-animation-duration $dialog-transition-timing;
    }
  }
}

@keyframes sv-dialog-side-entry {
  from {
    transform: translate(100%, -50%);
    opacity: 0;
  }
  to {
    transform: translate(-50%, -50%);
    opacity: 1;
  }
}

@keyframes sv-dialog-side-exit {
  from {
    transform: translate(-50%, -50%);
    opacity: 1;
  }
  to {
    transform: translate(100%, -50%);
    opacity: 0;
  }
}

/* ==========================================================================
   8. DIALOG BACKDROP
   ========================================================================== */

.sv-dialog-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  z-index: $dialog-backdrop-z-index;
  display: none;
  
  &.is-visible {
    display: block;
  }
  
  &.is-entering {
    animation: sv-dialog-backdrop-fade-in 0.2s ease-out;
    display: block;
  }
  
  &.is-exiting {
    animation: sv-dialog-backdrop-fade-out 0.2s ease-in;
    display: block;
  }
}

@keyframes sv-dialog-backdrop-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes sv-dialog-backdrop-fade-out {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

/* ==========================================================================
   9. RESPONSIVE ADAPTATIONS
   ========================================================================== */

@include responsive.media-breakpoint-down(sm) {
  .sv-dialog {
    width: calc(100vw - var(--sv-space-4));
    max-width: none;
    max-height: calc(100vh - var(--sv-space-4));
    
    &__header {
      padding: var(--sv-space-3) var(--sv-space-4);
    }
    
    &__body {
      padding: var(--sv-space-4);
      max-height: 70vh;
      overflow-y: auto;
    }
    
    &__footer {
      padding: var(--sv-space-3) var(--sv-space-4);
    }
    
    &__actions {
      flex-direction: column;
      gap: var(--sv-space-2);
      
      .sv-button {
        width: 100%;
      }
    }
  }
}

/* ==========================================================================
   10. ACCESSIBILITY ENHANCEMENTS
   ========================================================================== */

.sv-dialog {
  &.is-scrollable {
    .sv-dialog__body {
      max-height: 60vh;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
  }
  
  // For screen reader only content
  &__sr-description {
    @include a11y.visually-hidden;
  }
  
  &:focus {
    outline: none;
  }
}