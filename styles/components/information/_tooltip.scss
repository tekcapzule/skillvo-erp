/**
 * Tooltip Component - Component-level Styles
 * Version: 1.1.0
 * Last Updated: July 15, 2024
 * 
 * This file defines styles for the Tooltip component in the SkillVo design system.
 * It extends the information-display-base class and provides tooltip-specific styling.
 */

/* ==========================================================================
   TABLE OF CONTENTS:
   
   1. IMPORTS
   2. VARIABLES & CONFIGURATION
   3. TOOLTIP BASE CLASS
   4. TOOLTIP VARIATIONS
   5. TOOLTIP POSITIONS
   6. TOOLTIP ANIMATIONS
   7. TOOLTIP STATES
   8. RESPONSIVE ADAPTATIONS
   9. ACCESSIBILITY ENHANCEMENTS
   ========================================================================== */

/* ==========================================================================
   1. IMPORTS
   ========================================================================== */
@use './../../abstracts' as *;
@use './../../base/' as *;
@use './../../base/utils/mixins/state' as state;
@use './../../base/utils/mixins/layout' as layout;
@use './../../base/utils/mixins/responsive' as responsive;
@use 'sass:math';

/* ==========================================================================
   2. VARIABLES & CONFIGURATION
   ========================================================================== */

// Tooltip-specific variables
$tooltip-font-size: var(--sv-font-size-xs);
$tooltip-font-weight: var(--sv-font-weight-normal);
$tooltip-line-height: var(--sv-line-height-normal);
$tooltip-padding-x: var(--sv-space-3);
$tooltip-padding-y: var(--sv-space-2);
$tooltip-border-radius: var(--sv-radius-sm);
$tooltip-max-width: 250px;
$tooltip-z-index: var(--sv-z-index-tooltip);

// Tooltip colors
$tooltip-bg-color: var(--sv-bg-tooltip);
$tooltip-text-color: var(--sv-text-on-dark);
$tooltip-border-color: transparent;

// Tooltip arrow
$tooltip-arrow-size: 6px;
$tooltip-arrow-color: $tooltip-bg-color;

// Tooltip animation
$tooltip-transition-duration: var(--sv-motion-duration-short);
$tooltip-transition-timing: var(--sv-motion-ease-standard);
$tooltip-animation-duration: 200ms;

// Tooltip offset
$tooltip-offset: $tooltip-arrow-size;

/* ==========================================================================
   3. TOOLTIP BASE CLASS
   ========================================================================== */

.sv-tooltip {
  // Extend the information display base class
  @extend .sv-information-display-base ;
  
  // Override and add tooltip-specific styles
  position: absolute;
  display: block;
  font-size: $tooltip-font-size;
  font-weight: $tooltip-font-weight;
  line-height: $tooltip-line-height;
  padding: $tooltip-padding-y $tooltip-padding-x;
  border-radius: $tooltip-border-radius;
  max-width: $tooltip-max-width;
  z-index: $tooltip-z-index;
  
  // Visual styling
  color: $tooltip-text-color;
  background-color: $tooltip-bg-color;
  border: 1px solid $tooltip-border-color;
  
  // Text handling
  text-align: center;
  white-space: normal;
  word-wrap: break-word;
  
  // Prevent text selection in tooltips
  user-select: none;
  
  // Base transitions
  transition: opacity $tooltip-transition-duration $tooltip-transition-timing,
              transform $tooltip-transition-duration $tooltip-transition-timing;
  
  // Default state (hidden unless triggered)
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  
  // Arrow element
  &__arrow {
    position: absolute;
    width: 0;
    height: 0;
    border: $tooltip-arrow-size solid transparent;
  }
  
  // Container for tooltip content
  &__content {
    position: relative;
    z-index: 1;
  }
  
  // Tooltip container (for positioning)
  &-container {
    position: relative;
    display: inline-block;
    vertical-align: middle;
  }
}

/* ==========================================================================
   4. TOOLTIP VARIATIONS
   ========================================================================== */

.sv-tooltip {
  // Light variant with dark text on light background
  &--light {
    background-color: var(--sv-bg-surface);
    color: var(--sv-text-primary);
    border-color: var(--sv-border-light);
    box-shadow: var(--sv-shadow-sm);
    
    .sv-tooltip__arrow {
      &::before {
        border-color: var(--sv-border-light);
      }
      
      &::after {
        border-color: var(--sv-bg-surface);
      }
    }
  }
  
  // Interactive tooltips (that can be clicked)
  &--interactive {
    pointer-events: auto;
  }
  
  // Wide tooltip for more content
  &--wide {
    max-width: 350px;
  }
  
  // Narrow tooltip for fewer words
  &--narrow {
    max-width: 150px;
  }
  
  // Custom width tooltip
  &--custom-width {
    max-width: none;
  }
}

/* ==========================================================================
   5. TOOLTIP POSITIONS
   ========================================================================== */

.sv-tooltip {
  // Top position (arrow at bottom)
  &--top {
    margin-bottom: $tooltip-offset;
    
    .sv-tooltip__arrow {
      bottom: -$tooltip-arrow-size;
      left: 50%;
      margin-left: -$tooltip-arrow-size;
      border-bottom-width: 0;
      border-top-color: $tooltip-arrow-color;
    }
  }
  
  // Bottom position (arrow at top)
  &--bottom {
    margin-top: $tooltip-offset;
    
    .sv-tooltip__arrow {
      top: -$tooltip-arrow-size;
      left: 50%;
      margin-left: -$tooltip-arrow-size;
      border-top-width: 0;
      border-bottom-color: $tooltip-arrow-color;
    }
  }
  
  // Left position (arrow at right)
  &--left {
    margin-right: $tooltip-offset;
    
    .sv-tooltip__arrow {
      right: -$tooltip-arrow-size;
      top: 50%;
      margin-top: -$tooltip-arrow-size;
      border-right-width: 0;
      border-left-color: $tooltip-arrow-color;
    }
  }
  
  // Right position (arrow at left)
  &--right {
    margin-left: $tooltip-offset;
    
    .sv-tooltip__arrow {
      left: -$tooltip-arrow-size;
      top: 50%;
      margin-top: -$tooltip-arrow-size;
      border-left-width: 0;
      border-right-color: $tooltip-arrow-color;
    }
  }
  
  // Arrow alignment modifiers
  &--arrow-start {
    &.sv-tooltip--top, &.sv-tooltip--bottom {
      .sv-tooltip__arrow {
        left: $tooltip-padding-x;
        margin-left: 0;
      }
    }
    
    &.sv-tooltip--left, &.sv-tooltip--right {
      .sv-tooltip__arrow {
        top: $tooltip-padding-y;
        margin-top: 0;
      }
    }
  }
  
  &--arrow-end {
    &.sv-tooltip--top, &.sv-tooltip--bottom {
      .sv-tooltip__arrow {
        right: $tooltip-padding-x;
        left: auto;
        margin-left: 0;
      }
    }
    
    &.sv-tooltip--left, &.sv-tooltip--right {
      .sv-tooltip__arrow {
        bottom: $tooltip-padding-y;
        top: auto;
        margin-top: 0;
      }
    }
  }
}

/* ==========================================================================
   6. TOOLTIP ANIMATIONS
   ========================================================================== */

.sv-tooltip {
  // Fade animation
  &--animation-fade {
    &.is-visible {
      opacity: 1;
      visibility: visible;
    }
  }
  
  // Scale animation
  &--animation-scale {
    transform: scale(0.8);
    
    &.is-visible {
      opacity: 1;
      visibility: visible;
      transform: scale(1);
    }
  }
  
  // Slide animations based on position
  &--animation-slide {
    &.sv-tooltip--top {
      transform: translateY(10px);
    }
    
    &.sv-tooltip--bottom {
      transform: translateY(-10px);
    }
    
    &.sv-tooltip--left {
      transform: translateX(10px);
    }
    
    &.sv-tooltip--right {
      transform: translateX(-10px);
    }
    
    &.is-visible {
      opacity: 1;
      visibility: visible;
      transform: translate(0, 0);
    }
  }
}

/* ==========================================================================
   7. TOOLTIP STATES
   ========================================================================== */

.sv-tooltip {
  // Visible state
  &.is-visible {
    opacity: 1;
    visibility: visible;
  }
  
  // Disabled state
  &.is-disabled {
    display: none;
  }
  
  // Persistent tooltip (doesn't disappear on mouseout)
  &.is-persistent {
    pointer-events: auto;
  }
}

/* ==========================================================================
   8. RESPONSIVE ADAPTATIONS
   ========================================================================== */

@include responsive.breakpoint-down(sm) {
  .sv-tooltip {
    // Smaller text on mobile
    font-size: calc($tooltip-font-size * 0.9);
    
    // Reduced padding on mobile
    padding: calc($tooltip-padding-y * 0.8) calc($tooltip-padding-x * 0.8);
    
    // Force to bottom on mobile for better visibility
    &:not(.sv-tooltip--force-position) {
      &.sv-tooltip--top, &.sv-tooltip--left, &.sv-tooltip--right {
        margin: $tooltip-offset 0 0 0;
        
        .sv-tooltip__arrow {
          top: -$tooltip-arrow-size;
          left: 50%;
          right: auto;
          bottom: auto;
          margin-left: -$tooltip-arrow-size;
          margin-top: 0;
          border: $tooltip-arrow-size solid transparent;
          border-top-width: 0;
          border-bottom-color: $tooltip-arrow-color;
        }
      }
    }
    
    // Adjust width constraints on mobile
    &--wide, &--narrow {
      max-width: calc(100vw - 32px);
    }
  }
}

/* ==========================================================================
   9. ACCESSIBILITY ENHANCEMENTS
   ========================================================================== */

// Hide tooltips when user prefers reduced motion
@media (prefers-reduced-motion: reduce) {
  .sv-tooltip {
    transition: opacity 50ms linear;
    
    &--animation-scale, &--animation-slide {
      transform: none;
    }
  }
}

// High contrast mode enhancements
@media (forced-colors: active) {
  .sv-tooltip {
    border: 1px solid CanvasText;
    color: CanvasText;
    background-color: Canvas;
    
    .sv-tooltip__arrow {
      display: none;
    }
  }
}